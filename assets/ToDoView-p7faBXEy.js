import{u as w,r as i,a as _,h as x,i as C,c,b as e,w as m,v as T,n as d,F as k,f as I,o as v,j as S,t as p,k as V}from"./index-CJJd-li8.js";import{a as y}from"./axios-DoRVR6m2.js";const D={class:"content"},B={class:"button-group"},L={class:"input-group"},M=e("p",null,[e("span",null,"代辦事項ID:"),e("span",null,"代辦事項:"),e("span",null,"狀態:")],-1),U={class:"detail"},$=["onUpdate:modelValue"],N={__name:"ToDoView",setup(z){const n=w(),o=i(""),r=i([]),l=i("all"),b=_();x(async()=>{n.isLoggedIn?await f():b.push("/login")});const f=async()=>{try{const s=await y.post("/tasks",{user_id:n.userId});s.data.success?r.value=s.data.tasks:alert("加載任務失敗")}catch(s){console.error("加載任務失敗:",s),alert("加載任務失敗")}},g=async()=>{if(o.value.trim()===""){alert("請輸入代辦事項");return}if(!n.isLoggedIn){alert("請先登入");return}try{if((await y.post("/create",{text:o.value,user_id:n.userId})).data.success)await f(),o.value="",alert("新增成功");else throw new Error("響應數據格式不正確")}catch(s){console.error("新增失敗:",s),alert("新增失敗")}},h=C(()=>l.value==="all"?r.value:r.value.filter(s=>s.status===l.value));return(s,a)=>(v(),c(k,null,[e("div",D,[m(e("input",{class:"text",type:"text","onUpdate:modelValue":a[0]||(a[0]=t=>o.value=t),placeholder:"請輸入代辦事項"},null,512),[[T,o.value]]),e("button",{class:"ad",onClick:g},"新增")]),e("div",B,[e("button",{onClick:a[1]||(a[1]=t=>l.value="all"),class:d({active:l.value==="all"})},"全部(all)",2),e("button",{onClick:a[2]||(a[2]=t=>l.value="已完成"),class:d({active:l.value==="true"})},"已完成 (Completed)",2),e("button",{onClick:a[3]||(a[3]=t=>l.value="未完成"),class:d({active:l.value==="false"})},"未完成(Not completed)",2)]),e("div",L,[e("div",null,[M,(v(!0),c(k,null,I(h.value,t=>(v(),c("li",{key:t.id},[e("div",U,[m(e("input",{class:"checkbox",type:"checkbox","onUpdate:modelValue":u=>t.status=u,onChange:a[4]||(a[4]=(...u)=>s.saveTasks&&s.saveTasks(...u)),"true-value":"已完成","false-value":"未完成"},null,40,$),[[S,t.status]]),e("span",null,p(t.createid),1),e("span",null,p(t.text),1),e("span",{style:V({color:t.status==="已完成"?"#dc3545":"black"})},p(t.status),5)])]))),128))])])],64))}};export{N as default};
